import requests
import json

def get_json_from_github(url):
    # 发送GET请求获取JSON文件内容
    response = requests.get(url)
    
    # 检查请求是否成功
    if response.status_code == 200:
        json_content = response.json()
        return json_content
    else:
        # 请求失败时打印错误信息
        print('Request failed with status code:', response.status_code)

# 示例使用：读取GitHub的JSON文件内容
# https://github.com/CVEProject/cvelistV5/tree/main/cves/2016/7xxx
repo_owner = 'CVEProject'
repo_name = 'cvelistV5'
json_file_path = 'cves/2016/7xxx'  # JSON文件的路径

# 构建API请求URL
api_url = f'https://api.github.com/repos/{repo_owner}/{repo_name}/contents/{json_file_path}'

json_content = get_json_from_github(api_url)
if json_content:
    # print('JSON file content:', json_content)
    # 导出格式化后的json文件到本地
    with open(f'temp/{repo_name}.json', 'w') as f:
        json.dump(json_content, f, indent=4)
else:
    print('Failed to retrieve JSON file content.')